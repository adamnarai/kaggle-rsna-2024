project_name: rsna-2024
seed: 42
debug: False
deterministic: True
benchmark: False

# Wandb
use_wandb: False
tags:
  - coord_sagt1
notes: ''

labels:
  Normal/Mild: 0
  Moderate: 1
  Severe: 2

out_vars: &out_vars
  - spinal_canal_stenosis_l1_l2
  - spinal_canal_stenosis_l2_l3
  - spinal_canal_stenosis_l3_l4
  - spinal_canal_stenosis_l4_l5
  - spinal_canal_stenosis_l5_s1
  - left_neural_foraminal_narrowing_l1_l2
  - left_neural_foraminal_narrowing_l2_l3
  - left_neural_foraminal_narrowing_l3_l4
  - left_neural_foraminal_narrowing_l4_l5
  - left_neural_foraminal_narrowing_l5_s1
  - right_neural_foraminal_narrowing_l1_l2
  - right_neural_foraminal_narrowing_l2_l3
  - right_neural_foraminal_narrowing_l3_l4
  - right_neural_foraminal_narrowing_l4_l5
  - right_neural_foraminal_narrowing_l5_s1
  - left_subarticular_stenosis_l1_l2
  - left_subarticular_stenosis_l2_l3
  - left_subarticular_stenosis_l3_l4
  - left_subarticular_stenosis_l4_l5
  - left_subarticular_stenosis_l5_s1
  - right_subarticular_stenosis_l1_l2
  - right_subarticular_stenosis_l2_l3
  - right_subarticular_stenosis_l3_l4
  - right_subarticular_stenosis_l4_l5
  - right_subarticular_stenosis_l5_s1

model:
  type: SplitCoordModel
  args:
    base_model: DeepLabV3Plus
    encoder_name: resnet34
    num_classes: [5, 0, 0]
    in_channels: [5, 0, 0]

dataset:
  type: SplitCoordDataset
  args:
    img_num: [5, 0, 0]
    heatmap_std: 10
    resolution: [512, 512]
    data_dir: data/raw
    out_vars: *out_vars
    series_description: 'Sagittal T1'

data_loader:
  type: BaseDataLoader
  args:
    batch_size: 16
    num_workers: 8
    pin_memory: True
    shuffle: True

train_transform:
  type: CombinedV1
  args:
    scale: [1, 1]
    translate_percent: [0, 0]
    rotate: [-15, 15]
    shear: {'x': [-15, 15], 'y': [-15, 15]}
    p: 1.0

valid_transform:
  type: NoAug
  args: {}

optimizer:
  type: AdamW
  args:
    lr: 0.001

loss:
  type: MSELoss
  args: {}

scheduler:
  type: CosineAnnealingLR
  args:
    T_max: 30

trainer:
  epochs: 30
  cv_fold: 5
  one_fold: False
  metrics: ['loss']
  type: standard
